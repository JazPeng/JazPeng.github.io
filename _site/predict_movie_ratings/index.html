<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta charset="UTF-8">
  <title>Jasmine Holdsworth</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
</head>

  <body>
    <section class="page-header">
  <h1 class="project-name">Jasmine Holdsworth</h1>
  <h2 class="project-tagline"><html>I am a Senior Data Analyst/Data Scientist based in London. I love R, Python, and anything data-related. I have previously worked at <b>Stack Overflow</b> and <b>DAZN</b>. I currently teach at <b>General Assembly</b> and work at <b>Expedia</b>.</html></h2>
  <a href="/aboutme/" class="btn">About Me</a>
  <a href="/" class="btn">Projects</a>
  <a href="https://github.com/JazPeng" target="_blank" class="btn">GitHub</a>
  <a href="https://twitter.com/StackJaz" target="_blank" class="btn">Twitter</a>
  <a href="https://www.linkedin.com/in/jasmine-pengelly-a59b5552/" target="_blank" class="btn">LinkedIn</a>
</section>


    <section class="main-content">
      
      <h1 id="predicting-imdb-ratings-for-movies"><center>Predicting IMDB ratings for movies</center></h1>
<h2 id="python"><center>Python</center></h2>

<p>I consider myself an enthusiastic, if not particularly knowledgable, cinephile. When debating between multiple movies to watch, my partner and I always do the “IMDB test” - the movie we choose is the one with the highest average rating on IMDB (I plan  to create a movie recommender system to replace this method at some point, but that’s another blog post). I would like to see how easy it could be to predict the average rating for a movie, and what predictors have the most effect.</p>

<p>The dataset I used is the popular <a href="https://www.kaggle.com/rounakbanik/the-movies-dataset">Movies dataset</a> found on Kaggle. The aim is to try different models and find the one with the lowest root mean squared error (RMSE).</p>

<p>Once I have identified the best performing model, I will create a Flask app to allow users to create their own movies using the given feature options (cast, crew etc) and predict the rating and the revenue it would generate. It would also be worth hooking this up to the OMBd API to get the most up-to-date movie information.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib_venn</span> <span class="kn">import</span> <span class="n">venn2</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span> <span class="k">as</span> <span class="n">lm</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">ensemble</span><span class="p">,</span> <span class="n">model_selection</span> <span class="k">as</span> <span class="n">ms</span><span class="p">,</span> <span class="n">feature_selection</span><span class="p">,</span> <span class="n">svm</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="bp">None</span> 

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">"ignore"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span>
    <span class="s">'figure.figsize'</span><span class="p">:</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="s">'font.size'</span><span class="p">:</span> <span class="mi">14</span>
<span class="p">})</span>

<span class="c"># Set palette</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s">"husl"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.max_columns'</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.max_rows'</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="import-and-prepare-the-datasets-ill-be-using">Import and prepare the datasets I’ll be using</h2>

<p>The Movies dataset has multiple csvs which contain data in json format. I will extract each element from each csv that I want to use and put it into a tabular format. I will then combine all these different tables into one master table.</p>

<h3 id="creditscsv">credits.csv</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">credits</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"/Users/jasminepengelly/Desktop/projects/predicting_movie/movie_revenue_predictor/credits.csv"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">credits</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cast</th>
      <th>crew</th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[{'cast_id': 14, 'character': 'Woody (voice)',...</td>
      <td>[{'credit_id': '52fe4284c3a36847f8024f49', 'de...</td>
      <td>862</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[{'cast_id': 1, 'character': 'Alan Parrish', '...</td>
      <td>[{'credit_id': '52fe44bfc3a36847f80a7cd1', 'de...</td>
      <td>8844</td>
    </tr>
  </tbody>
</table>
</div>

<p>There is a lot of nesting, so I’ll use a for loop to separate out the relevant elements.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">all_casts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">all_crews</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">credits</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">cast</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">credits</span><span class="p">[</span><span class="s">'cast'</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cast</span><span class="p">:</span>
        <span class="n">x</span><span class="p">[</span><span class="s">'movie_id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">credits</span><span class="p">[</span><span class="s">'id'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">crew</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">credits</span><span class="p">[</span><span class="s">'crew'</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">crew</span><span class="p">:</span>
        <span class="n">x</span><span class="p">[</span><span class="s">'movie_id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">credits</span><span class="p">[</span><span class="s">'id'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">all_casts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">cast</span><span class="p">)</span>
    <span class="n">all_crews</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">crew</span><span class="p">)</span>

<span class="n">all_casts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_casts</span><span class="p">)</span>
<span class="n">all_crews</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_crews</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">all_casts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cast_id</th>
      <th>character</th>
      <th>credit_id</th>
      <th>gender</th>
      <th>id</th>
      <th>movie_id</th>
      <th>name</th>
      <th>order</th>
      <th>profile_path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14</td>
      <td>Woody (voice)</td>
      <td>52fe4284c3a36847f8024f95</td>
      <td>2</td>
      <td>31</td>
      <td>862</td>
      <td>Tom Hanks</td>
      <td>0</td>
      <td>/pQFoyx7rp09CJTAb932F2g8Nlho.jpg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15</td>
      <td>Buzz Lightyear (voice)</td>
      <td>52fe4284c3a36847f8024f99</td>
      <td>2</td>
      <td>12898</td>
      <td>862</td>
      <td>Tim Allen</td>
      <td>1</td>
      <td>/uX2xVf6pMmPepxnvFWyBtjexzgY.jpg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16</td>
      <td>Mr. Potato Head (voice)</td>
      <td>52fe4284c3a36847f8024f9d</td>
      <td>2</td>
      <td>7167</td>
      <td>862</td>
      <td>Don Rickles</td>
      <td>2</td>
      <td>/h5BcaDMPRVLHLDzbQavec4xfSdt.jpg</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17</td>
      <td>Slinky Dog (voice)</td>
      <td>52fe4284c3a36847f8024fa1</td>
      <td>2</td>
      <td>12899</td>
      <td>862</td>
      <td>Jim Varney</td>
      <td>3</td>
      <td>/eIo2jVVXYgjDtaHoF19Ll9vtW7h.jpg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18</td>
      <td>Rex (voice)</td>
      <td>52fe4284c3a36847f8024fa5</td>
      <td>2</td>
      <td>12900</td>
      <td>862</td>
      <td>Wallace Shawn</td>
      <td>4</td>
      <td>/oGE6JqPP2xH4tNORKNqxbNPYi7u.jpg</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">all_crews</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>credit_id</th>
      <th>department</th>
      <th>gender</th>
      <th>id</th>
      <th>job</th>
      <th>movie_id</th>
      <th>name</th>
      <th>profile_path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>52fe4284c3a36847f8024f49</td>
      <td>Directing</td>
      <td>2</td>
      <td>7879</td>
      <td>Director</td>
      <td>862</td>
      <td>John Lasseter</td>
      <td>/7EdqiNbr4FRjIhKHyPPdFfEEEFG.jpg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>52fe4284c3a36847f8024f4f</td>
      <td>Writing</td>
      <td>2</td>
      <td>12891</td>
      <td>Screenplay</td>
      <td>862</td>
      <td>Joss Whedon</td>
      <td>/dTiVsuaTVTeGmvkhcyJvKp2A5kr.jpg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>52fe4284c3a36847f8024f55</td>
      <td>Writing</td>
      <td>2</td>
      <td>7</td>
      <td>Screenplay</td>
      <td>862</td>
      <td>Andrew Stanton</td>
      <td>/pvQWsu0qc8JFQhMVJkTHuexUAa1.jpg</td>
    </tr>
    <tr>
      <th>3</th>
      <td>52fe4284c3a36847f8024f5b</td>
      <td>Writing</td>
      <td>2</td>
      <td>12892</td>
      <td>Screenplay</td>
      <td>862</td>
      <td>Joel Cohen</td>
      <td>/dAubAiZcvKFbboWlj7oXOkZnTSu.jpg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>52fe4284c3a36847f8024f61</td>
      <td>Writing</td>
      <td>0</td>
      <td>12893</td>
      <td>Screenplay</td>
      <td>862</td>
      <td>Alec Sokolow</td>
      <td>/v79vlRYi94BZUQnkkyznbGUZLjT.jpg</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="cast">Cast</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cast</span> <span class="o">=</span> <span class="n">all_casts</span><span class="p">[[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'order'</span><span class="p">,</span> <span class="s">'gender'</span><span class="p">,</span> <span class="s">'movie_id'</span><span class="p">]]</span>
<span class="n">cast</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>order</th>
      <th>gender</th>
      <th>movie_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom Hanks</td>
      <td>0</td>
      <td>2</td>
      <td>862</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tim Allen</td>
      <td>1</td>
      <td>2</td>
      <td>862</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Don Rickles</td>
      <td>2</td>
      <td>2</td>
      <td>862</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jim Varney</td>
      <td>3</td>
      <td>2</td>
      <td>862</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Wallace Shawn</td>
      <td>4</td>
      <td>2</td>
      <td>862</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="crew">Crew</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">crew</span> <span class="o">=</span> <span class="n">all_crews</span><span class="p">[[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'job'</span><span class="p">,</span> <span class="s">'gender'</span><span class="p">,</span> <span class="s">'movie_id'</span><span class="p">]]</span>
<span class="n">crew</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>job</th>
      <th>gender</th>
      <th>movie_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Lasseter</td>
      <td>Director</td>
      <td>2</td>
      <td>862</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Joss Whedon</td>
      <td>Screenplay</td>
      <td>2</td>
      <td>862</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Andrew Stanton</td>
      <td>Screenplay</td>
      <td>2</td>
      <td>862</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Joel Cohen</td>
      <td>Screenplay</td>
      <td>2</td>
      <td>862</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Alec Sokolow</td>
      <td>Screenplay</td>
      <td>0</td>
      <td>862</td>
    </tr>
  </tbody>
</table>
</div>

<p>This worked well - I know how the features I would like to use for my models in an easy-to-use format.</p>

<h3 id="movies_metadatacsv">movies_metadata.csv</h3>
<p>There are a lot of data in this csv that I do not consider relevant to use for my features. I will have to extract the data I want to use.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">movies_metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"/Users/jasminepengelly/Desktop/projects/predicting_movie/movie_revenue_predictor/movies_metadata.csv"</span><span class="p">,</span> <span class="n">low_memory</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">movies_metadata</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adult</th>
      <th>belongs_to_collection</th>
      <th>budget</th>
      <th>genres</th>
      <th>homepage</th>
      <th>id</th>
      <th>imdb_id</th>
      <th>original_language</th>
      <th>original_title</th>
      <th>overview</th>
      <th>popularity</th>
      <th>poster_path</th>
      <th>production_companies</th>
      <th>production_countries</th>
      <th>release_date</th>
      <th>revenue</th>
      <th>runtime</th>
      <th>spoken_languages</th>
      <th>status</th>
      <th>tagline</th>
      <th>title</th>
      <th>video</th>
      <th>vote_average</th>
      <th>vote_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>{'id': 10194, 'name': 'Toy Story Collection', ...</td>
      <td>30000000</td>
      <td>[{'id': 16, 'name': 'Animation'}, {'id': 35, '...</td>
      <td>http://toystory.disney.com/toy-story</td>
      <td>862</td>
      <td>tt0114709</td>
      <td>en</td>
      <td>Toy Story</td>
      <td>Led by Woody, Andy's toys live happily in his ...</td>
      <td>21.946943</td>
      <td>/rhIRbceoE9lR4veEXuwCC2wARtG.jpg</td>
      <td>[{'name': 'Pixar Animation Studios', 'id': 3}]</td>
      <td>[{'iso_3166_1': 'US', 'name': 'United States o...</td>
      <td>1995-10-30</td>
      <td>373554033.0</td>
      <td>81.0</td>
      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>
      <td>Released</td>
      <td>NaN</td>
      <td>Toy Story</td>
      <td>False</td>
      <td>7.7</td>
      <td>5415.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>NaN</td>
      <td>65000000</td>
      <td>[{'id': 12, 'name': 'Adventure'}, {'id': 14, '...</td>
      <td>NaN</td>
      <td>8844</td>
      <td>tt0113497</td>
      <td>en</td>
      <td>Jumanji</td>
      <td>When siblings Judy and Peter discover an encha...</td>
      <td>17.015539</td>
      <td>/vzmL6fP7aPKNKPRTFnZmiUfciyV.jpg</td>
      <td>[{'name': 'TriStar Pictures', 'id': 559}, {'na...</td>
      <td>[{'iso_3166_1': 'US', 'name': 'United States o...</td>
      <td>1995-12-15</td>
      <td>262797249.0</td>
      <td>104.0</td>
      <td>[{'iso_639_1': 'en', 'name': 'English'}, {'iso...</td>
      <td>Released</td>
      <td>Roll the dice and unleash the excitement!</td>
      <td>Jumanji</td>
      <td>False</td>
      <td>6.9</td>
      <td>2413.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Again, there will be a lot of unpicking required here. I’ll intuitively select the features I would like to use and clean them, for example dummifying the <strong>belongs_to_collection</strong> column.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">metadata</span> <span class="o">=</span> <span class="n">movies_metadata</span><span class="p">[[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'id'</span><span class="p">,</span> <span class="s">'budget'</span><span class="p">,</span>  <span class="s">'revenue'</span><span class="p">,</span> <span class="s">'runtime'</span><span class="p">,</span> <span class="s">'vote_average'</span><span class="p">,</span> 
                            <span class="s">'vote_count'</span><span class="p">,</span> <span class="s">'belongs_to_collection'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">metadata</span><span class="p">[</span><span class="s">'belongs_to_collection'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s">'0'</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">collection</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[[</span><span class="s">'belongs_to_collection'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">collection</span><span class="p">[</span><span class="n">collection</span> <span class="o">!=</span> <span class="s">'0'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'1'</span>
<span class="n">metadata</span><span class="p">[</span><span class="s">'belongs_to_collection'</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">metadata</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>id</th>
      <th>budget</th>
      <th>revenue</th>
      <th>runtime</th>
      <th>vote_average</th>
      <th>vote_count</th>
      <th>belongs_to_collection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Toy Story</td>
      <td>862</td>
      <td>30000000</td>
      <td>373554033.0</td>
      <td>81.0</td>
      <td>7.7</td>
      <td>5415.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jumanji</td>
      <td>8844</td>
      <td>65000000</td>
      <td>262797249.0</td>
      <td>104.0</td>
      <td>6.9</td>
      <td>2413.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Grumpier Old Men</td>
      <td>15602</td>
      <td>0</td>
      <td>0.0</td>
      <td>101.0</td>
      <td>6.5</td>
      <td>92.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Waiting to Exhale</td>
      <td>31357</td>
      <td>16000000</td>
      <td>81452156.0</td>
      <td>127.0</td>
      <td>6.1</td>
      <td>34.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Father of the Bride Part II</td>
      <td>11862</td>
      <td>0</td>
      <td>76578911.0</td>
      <td>106.0</td>
      <td>5.7</td>
      <td>173.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>I want to also include the movie genre as a feature, but this is nested. I will extract the relevant column and transform it into a workable format. Since movies can belong to one genre, I will have to take this into account by creating a <strong>tmp</strong> column which will as an indicator as to whether that movie belongs to that genre - this will come in handy later.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">g</span> <span class="o">=</span> <span class="n">movies_metadata</span><span class="p">[[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'genres'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genlist</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">gen</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="s">'genres'</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
        <span class="n">each</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s">'id'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">genlist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="n">genre</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">genlist</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genre</span> <span class="o">=</span> <span class="n">genre</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'name'</span><span class="p">:</span><span class="s">'genre'</span><span class="p">})</span>
<span class="n">genre</span> <span class="o">=</span> <span class="n">genre</span><span class="p">[[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">]]</span>
<span class="n">genre</span><span class="p">[</span><span class="s">'tmp'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">genre</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>genre</th>
      <th>tmp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>862</td>
      <td>Animation</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>862</td>
      <td>Comedy</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>862</td>
      <td>Family</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8844</td>
      <td>Adventure</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8844</td>
      <td>Fantasy</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>I will now create a pivot table out of my <strong>genre</strong> DataFrame, filling all the null cells (ie. the ones  that do not contain 1s) with 0. This means every movies’ genre is indicated by a 1 or 0.</p>

<p>I can now merge my <strong>genres</strong> data frame to my metadata DataFrame.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pivot</span> <span class="o">=</span> <span class="n">genre</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s">'tmp'</span><span class="p">,</span> <span class="s">'id'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">flattened</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pivot</span><span class="o">.</span><span class="n">to_records</span><span class="p">())</span>
<span class="n">metadata_genre</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">flattened</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">'id'</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">'left'</span><span class="p">)</span>
<span class="n">metadata_genre</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>id</th>
      <th>budget</th>
      <th>revenue</th>
      <th>runtime</th>
      <th>vote_average</th>
      <th>vote_count</th>
      <th>belongs_to_collection</th>
      <th>Action</th>
      <th>Adventure</th>
      <th>Animation</th>
      <th>Aniplex</th>
      <th>BROSTA TV</th>
      <th>Carousel Productions</th>
      <th>Comedy</th>
      <th>Crime</th>
      <th>Documentary</th>
      <th>Drama</th>
      <th>Family</th>
      <th>Fantasy</th>
      <th>Foreign</th>
      <th>GoHands</th>
      <th>History</th>
      <th>Horror</th>
      <th>Mardock Scramble Production Committee</th>
      <th>Music</th>
      <th>Mystery</th>
      <th>Odyssey Media</th>
      <th>Pulser Productions</th>
      <th>Rogue State</th>
      <th>Romance</th>
      <th>Science Fiction</th>
      <th>Sentai Filmworks</th>
      <th>TV Movie</th>
      <th>Telescene Film Group Productions</th>
      <th>The Cartel</th>
      <th>Thriller</th>
      <th>Vision View Entertainment</th>
      <th>War</th>
      <th>Western</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Toy Story</td>
      <td>862</td>
      <td>30000000</td>
      <td>373554033.0</td>
      <td>81.0</td>
      <td>7.7</td>
      <td>5415.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jumanji</td>
      <td>8844</td>
      <td>65000000</td>
      <td>262797249.0</td>
      <td>104.0</td>
      <td>6.9</td>
      <td>2413.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Grumpier Old Men</td>
      <td>15602</td>
      <td>0</td>
      <td>0.0</td>
      <td>101.0</td>
      <td>6.5</td>
      <td>92.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Waiting to Exhale</td>
      <td>31357</td>
      <td>16000000</td>
      <td>81452156.0</td>
      <td>127.0</td>
      <td>6.1</td>
      <td>34.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Father of the Bride Part II</td>
      <td>11862</td>
      <td>0</td>
      <td>76578911.0</td>
      <td>106.0</td>
      <td>5.7</td>
      <td>173.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Now I’ll add the cast to the main dataframe, selecting the lead and the supporting actor as two of the features I would like to use.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lead</span> <span class="o">=</span> <span class="n">cast</span><span class="p">[</span><span class="n">cast</span><span class="p">[</span><span class="s">'order'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">lead</span> <span class="o">=</span> <span class="n">lead</span><span class="p">[[</span><span class="s">'movie_id'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">]]</span>
<span class="n">lead</span> <span class="o">=</span> <span class="n">lead</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'movie_id'</span><span class="p">:</span><span class="s">'id'</span><span class="p">})</span>
<span class="n">lead</span> <span class="o">=</span> <span class="n">lead</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'name'</span><span class="p">:</span><span class="s">'lead'</span><span class="p">})</span>
<span class="n">lead</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>lead</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>862</td>
      <td>Tom Hanks</td>
    </tr>
    <tr>
      <th>13</th>
      <td>8844</td>
      <td>Robin Williams</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Number of rows before dropping those with null values:"</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">metadata_genre</span><span class="p">))</span>
<span class="n">metadata_genre</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Number of rows after dropping those with null values:"</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">metadata_genre</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Number of rows before dropping those with null values: 45466
Number of rows after dropping those with null values: 42839
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">metadata_genre</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_genre</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'int64'</span><span class="p">)</span>
<span class="n">metadata_genre_lead</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">metadata_genre</span><span class="p">,</span> <span class="n">lead</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">'id'</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">'left'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">supporting</span> <span class="o">=</span> <span class="n">cast</span><span class="p">[</span><span class="n">cast</span><span class="p">[</span><span class="s">'order'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">supporting</span> <span class="o">=</span> <span class="n">supporting</span><span class="p">[[</span><span class="s">'movie_id'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">]]</span>
<span class="n">supporting</span> <span class="o">=</span> <span class="n">supporting</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'movie_id'</span><span class="p">:</span><span class="s">'id'</span><span class="p">})</span>
<span class="n">supporting</span> <span class="o">=</span> <span class="n">supporting</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'name'</span><span class="p">:</span><span class="s">'supporting'</span><span class="p">})</span>
<span class="n">metadata_genre_lead_supporting</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">metadata_genre_lead</span><span class="p">,</span> <span class="n">supporting</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">'id'</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">'left'</span><span class="p">)</span>
</code></pre></div></div>

<p>Now I’ll add the director.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">director</span> <span class="o">=</span> <span class="n">crew</span><span class="p">[</span><span class="n">crew</span><span class="p">[</span><span class="s">'job'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Director'</span><span class="p">]</span>
<span class="n">director</span> <span class="o">=</span> <span class="n">director</span><span class="p">[[</span><span class="s">'movie_id'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">]]</span>
<span class="n">director</span> <span class="o">=</span> <span class="n">director</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'movie_id'</span><span class="p">:</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">:</span><span class="s">'director'</span><span class="p">})</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">metadata_genre_lead_supporting</span><span class="p">,</span> <span class="n">director</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">'id'</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">'left'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Number of rows before dropping those with null values:"</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Number of rows after dropping those with null values:"</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Number of rows before dropping those with null values: 47632
Number of rows after dropping those with null values: 37580
</code></pre></div></div>

<p>Time for some cleaning. I’ll remove all rows with null revenue and budget and where the vote count was below 50. I’ll also convert each column to the appropriate data type and delete the duplicates.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'budget'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'0'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'revenue'</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">final_dataset</span><span class="p">[</span><span class="s">'budget'</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="p">[</span><span class="s">'budget'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'float64'</span><span class="p">)</span>
<span class="n">final_dataset</span><span class="p">[</span><span class="s">'belongs_to_collection'</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="p">[</span><span class="s">'belongs_to_collection'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'int64'</span><span class="p">)</span>
<span class="n">final_dataset</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="p">[</span><span class="n">final_dataset</span><span class="p">[</span><span class="s">'vote_count'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Before duplicates dropped:"</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">))</span>
<span class="n">final_dataset</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"After duplicates dropped:"</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Before duplicates dropped: 4676
After duplicates dropped: 4632
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final_dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>id</th>
      <th>budget</th>
      <th>revenue</th>
      <th>runtime</th>
      <th>vote_average</th>
      <th>vote_count</th>
      <th>belongs_to_collection</th>
      <th>Action</th>
      <th>Adventure</th>
      <th>Animation</th>
      <th>Aniplex</th>
      <th>BROSTA TV</th>
      <th>Carousel Productions</th>
      <th>Comedy</th>
      <th>Crime</th>
      <th>Documentary</th>
      <th>Drama</th>
      <th>Family</th>
      <th>Fantasy</th>
      <th>Foreign</th>
      <th>GoHands</th>
      <th>History</th>
      <th>Horror</th>
      <th>Mardock Scramble Production Committee</th>
      <th>Music</th>
      <th>Mystery</th>
      <th>Odyssey Media</th>
      <th>Pulser Productions</th>
      <th>Rogue State</th>
      <th>Romance</th>
      <th>Science Fiction</th>
      <th>Sentai Filmworks</th>
      <th>TV Movie</th>
      <th>Telescene Film Group Productions</th>
      <th>The Cartel</th>
      <th>Thriller</th>
      <th>Vision View Entertainment</th>
      <th>War</th>
      <th>Western</th>
      <th>lead</th>
      <th>supporting</th>
      <th>director</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Toy Story</td>
      <td>862</td>
      <td>30000000.0</td>
      <td>373554033.0</td>
      <td>81.0</td>
      <td>7.7</td>
      <td>5415.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Tom Hanks</td>
      <td>Tim Allen</td>
      <td>John Lasseter</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jumanji</td>
      <td>8844</td>
      <td>65000000.0</td>
      <td>262797249.0</td>
      <td>104.0</td>
      <td>6.9</td>
      <td>2413.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Robin Williams</td>
      <td>Jonathan Hyde</td>
      <td>Joe Johnston</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Heat</td>
      <td>949</td>
      <td>60000000.0</td>
      <td>187436818.0</td>
      <td>170.0</td>
      <td>7.7</td>
      <td>1886.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Al Pacino</td>
      <td>Robert De Niro</td>
      <td>Michael Mann</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Sudden Death</td>
      <td>9091</td>
      <td>35000000.0</td>
      <td>64350171.0</td>
      <td>106.0</td>
      <td>5.5</td>
      <td>174.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Jean-Claude Van Damme</td>
      <td>Powers Boothe</td>
      <td>Peter Hyams</td>
    </tr>
    <tr>
      <th>9</th>
      <td>GoldenEye</td>
      <td>710</td>
      <td>58000000.0</td>
      <td>352194034.0</td>
      <td>130.0</td>
      <td>6.6</td>
      <td>1194.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Pierce Brosnan</td>
      <td>Sean Bean</td>
      <td>Martin Campbell</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="dealing-with-multiple-directors">Dealing with multiple directors</h4>
<p>Though I managed to drop the duplicates above, I can see that some films have multiple directors. This leaves duplicated films that weren’t removed with the above because the <strong>director</strong> columns are different.</p>

<p>My intention was originally to dummify the directors and merge them with the original data frame. However, the data set became too large to process on my laptop so I’ll try again but with the least frequently appearing directors removed to make the dataset more manageable.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final_dataset</span><span class="p">[</span><span class="s">'dir_count'</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'director'</span><span class="p">)[</span><span class="s">'director'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s">'count'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final_dataset</span><span class="p">[</span><span class="s">'dir_count'</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'director'</span><span class="p">)[</span><span class="s">'director'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s">'count'</span><span class="p">)</span>
<span class="n">final_dataset</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="p">[</span><span class="n">final_dataset</span><span class="p">[</span><span class="s">"dir_count"</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">final_dataset_wo_dir</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s">"director"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s">"first"</span><span class="p">)</span>
<span class="n">directors</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="p">[[</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"director"</span><span class="p">]]</span>
</code></pre></div></div>

<p>I’ll now export the <em>final_dataset_wo_dir</em> for use in my next analysis, which will require the same cleaned features.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final_dataset_wo_dir</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"movies_wo_dir.csv"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="exploratory-data-analysis">Exploratory data analysis</h2>
<p>Now it’s time to look and at all of my features and look out for things like multicollinearity that could affect my model.</p>

<p>First, I’ll define my predictors (without <strong>director</strong>) and response variables.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="s">'budget'</span><span class="p">,</span> <span class="s">'runtime'</span><span class="p">,</span> <span class="s">'vote_count'</span><span class="p">,</span> <span class="s">'belongs_to_collection'</span><span class="p">,</span> <span class="s">'Action'</span><span class="p">,</span> <span class="s">'Adventure'</span><span class="p">,</span> 
              <span class="s">'Animation'</span><span class="p">,</span> <span class="s">'Aniplex'</span><span class="p">,</span> <span class="s">'BROSTA TV'</span><span class="p">,</span> <span class="s">'Carousel Productions'</span><span class="p">,</span> <span class="s">'Comedy'</span><span class="p">,</span> <span class="s">'Crime'</span><span class="p">,</span> <span class="s">'Documentary'</span><span class="p">,</span> <span class="s">'Drama'</span><span class="p">,</span>
              <span class="s">'Family'</span><span class="p">,</span> <span class="s">'Fantasy'</span><span class="p">,</span> <span class="s">'Foreign'</span><span class="p">,</span> <span class="s">'GoHands'</span><span class="p">,</span> <span class="s">'History'</span><span class="p">,</span> <span class="s">'Horror'</span><span class="p">,</span> <span class="s">'Mardock Scramble Production Committee'</span><span class="p">,</span>
              <span class="s">'Music'</span><span class="p">,</span> <span class="s">'Mystery'</span><span class="p">,</span> <span class="s">'Odyssey Media'</span><span class="p">,</span> <span class="s">'Pulser Productions'</span><span class="p">,</span> <span class="s">'Rogue State'</span><span class="p">,</span> <span class="s">'Romance'</span><span class="p">,</span> <span class="s">'Science Fiction'</span><span class="p">,</span>
              <span class="s">'Sentai Filmworks'</span><span class="p">,</span> <span class="s">'TV Movie'</span><span class="p">,</span> <span class="s">'Telescene Film Group Productions'</span><span class="p">,</span> <span class="s">'The Cartel'</span><span class="p">,</span> <span class="s">'Thriller'</span><span class="p">,</span> 
              <span class="s">'Vision View Entertainment'</span><span class="p">,</span> <span class="s">'War'</span><span class="p">,</span> <span class="s">'Western'</span><span class="p">,</span> <span class="s">'lead'</span><span class="p">,</span> <span class="s">'supporting'</span><span class="p">,</span> <span class="s">'revenue'</span><span class="p">]</span>

<span class="n">y</span> <span class="o">=</span> <span class="s">'vote_average'</span>
</code></pre></div></div>

<p>Now I’ll check for correlation between the predictors.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">final_dataset_wo_dir</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'id'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">diverging_palette</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a3a7dbeb8&gt;
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/JazPeng/assets/master/movies/correlation_rating.png" alt="Correlation Matrix" /></p>

<p><strong>vote_average</strong>, my response variable, isn’t highly correlated with any other variable, so there are not currently any stand-out features that I think will be particularly predictive.</p>

<p>Within my features, there are four stronger correlations :</p>

<ul>
  <li><strong>revenue</strong> and <strong>budget</strong></li>
  <li><strong>vote_count</strong> and <strong>budget</strong></li>
  <li><strong>revenue</strong> and <strong>vote_count</strong></li>
  <li><strong>family</strong> and <strong>animation</strong></li>
</ul>

<p>I’ll look at these relationships in greater detail below.</p>

<h4 id="revenue-and-budget"><em>revenue</em> and <em>budget</em></h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'revenue'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'budget'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_dataset_wo_dir</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Revenue vs Budget'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Revenue'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Budget'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/JazPeng/assets/master/movies/rev_vs_budget.png" alt="Revenue vs Budget" /></p>

<p>Since the points are very clustered together, I will visualise this a double-log scale to see if I can get a better view of the relationship.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rev_vs_bug</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'revenue'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'budget'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_dataset_wo_dir</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Revenue vs Budget'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Revenue'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Budget'</span><span class="p">)</span>
<span class="n">rev_vs_bug</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s">"log"</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s">"log"</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/JazPeng/assets/master/movies/rev_vs_budget_log.png" alt="Revenue vs Budget double log scale" /></p>

<p>The relationship is strong at 0.69, although it is not represented perfectly by a straight line. The correlation coefficient between <strong>revenue</strong> and <strong>budget</strong>. It also makes intuitive sense that movies that have larger budgets will attract larger audiences.</p>

<h4 id="revenue-and-vote_count"><em>revenue</em> and <em>vote_count</em></h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'revenue'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'vote_count'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_dataset_wo_dir</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Revenue vs Vote'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Revenue'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Vote'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/JazPeng/assets/master/movies/rev_vs_vcount.png" alt="Revenue vs Vote Count" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rev_vs_vote</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'revenue'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'vote_count'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_dataset_wo_dir</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Revenue vs Vote'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Revenue'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Vote'</span><span class="p">)</span>
<span class="n">rev_vs_vote</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s">"log"</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s">"log"</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="rev_vs_vcount_log.png" alt="Revenue vs Vote Count double log" /></p>

<p>Again, the relationship is better illustrated on a double-log scale and not perfectly represented by a straight line. The correlation coefficient between <strong>revenue</strong> and <strong>vote_count</strong> is even more significant at 0.74. As with the relationship between <strong>revenue</strong> and <strong>budget</strong>, the larger an audience the higher the number of votes can be expected.</p>

<h4 id="vote_count-and-budget"><em>vote_count</em> and <em>budget</em></h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'budget'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'vote_count'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_dataset_wo_dir</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Vote Count vs Budget'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Budget'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Vote Count'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="vcount_budget.png" alt="Vote Count vs Budget" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">votecount_vs_budget</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'budget'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'vote_count'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_dataset_wo_dir</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Vote Count vs Budget'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Budget'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Vote Count'</span><span class="p">)</span>
<span class="n">votecount_vs_budget</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s">"log"</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s">"log"</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/JazPeng/assets/master/movies/vcount_budget_log.png" alt="Vote Count vs Budget" /></p>

<p>Although there is a correlation coefficient of 0.52, the relationship is again not exactly linear. It appears films with a larger budget spent producing them tend to generate more votes, which makes sense.</p>

<h4 id="family-and-animation"><em>Family</em> and <em>Animation</em></h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Both</span>
<span class="n">both</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_dataset_wo_dir</span><span class="p">[(</span><span class="n">final_dataset_wo_dir</span><span class="p">[</span><span class="s">'Family'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">final_dataset_wo_dir</span><span class="p">[</span><span class="s">'Animation'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)])</span>

<span class="c"># Animation</span>
<span class="n">ani</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_dataset_wo_dir</span><span class="p">[</span><span class="n">final_dataset_wo_dir</span><span class="p">[</span><span class="s">'Animation'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>

<span class="c"># Family</span>
<span class="n">fam</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_dataset_wo_dir</span><span class="p">[</span><span class="n">final_dataset_wo_dir</span><span class="p">[</span><span class="s">'Family'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">venn2</span><span class="p">(</span><span class="n">subsets</span> <span class="o">=</span> <span class="p">(</span><span class="n">fam</span><span class="o">-</span><span class="n">both</span><span class="p">,</span> <span class="n">ani</span><span class="o">-</span><span class="n">both</span><span class="p">,</span> <span class="mi">67</span><span class="p">),</span> 
      <span class="n">set_labels</span> <span class="o">=</span> <span class="p">(</span><span class="s">'Family'</span><span class="p">,</span> <span class="s">'Animation'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/JazPeng/assets/master/movies/venn.png" alt="Venn Diagram" /></p>

<p>There are, in total, 78 films of genre ‘Animation’ and 186  films of genre ‘Family’. While most <strong>Animation</strong> films are also classified as <strong>Family</strong>, the same cannot be said for the other way around. Since this is the case, I will keep both predictors as they are in my models.</p>

<h3 id="the-highest-and-lowest-rated-films">The highest and lowest rated films</h3>
<h4 id="highest-rated">Highest rated</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final_dataset_wo_dir</span><span class="p">[[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'vote_average'</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s">'vote_average'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>vote_average</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849</th>
      <td>The Godfather</td>
      <td>8.5</td>
    </tr>
    <tr>
      <th>13316</th>
      <td>The Dark Knight</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>537</th>
      <td>Schindler's List</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>5766</th>
      <td>Spirited Away</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>2985</th>
      <td>Fight Club</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>1199</th>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>300</th>
      <td>Pulp Fiction</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>1225</th>
      <td>The Godfather: Part II</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>1223</th>
      <td>Psycho</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>297</th>
      <td>Leon: The Professional</td>
      <td>8.2</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="lowest-rated">Lowest rated</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final_dataset_wo_dir</span><span class="p">[[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'vote_average'</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s">'vote_average'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>vote_average</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13786</th>
      <td>Disaster Movie</td>
      <td>3.1</td>
    </tr>
    <tr>
      <th>12287</th>
      <td>Epic Movie</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>6795</th>
      <td>Gigli</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>11468</th>
      <td>Date Movie</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>13179</th>
      <td>Meet the Spartans</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>14420</th>
      <td>Street Fighter: The Legend of Chun-Li</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>19506</th>
      <td>Jack and Jill</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>22997</th>
      <td>The Canyons</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>30203</th>
      <td>The Boy Next Door</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>1557</th>
      <td>Speed 2: Cruise Control</td>
      <td>4.1</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="dummy-variables">Dummy variables</h3>
<p>As well as making the variables in the <strong>final_dataset_wo_dir</strong> dummy, I also need to manually add the directors. I’ll do this by creating a pivot table with the directors as columns, the movie id as the row and the values as either 0 or 1.</p>

<p>Since the feature importance of dummy variables relies on the baseline of the first variable that is dropped, I’ll make a note of whom that is in <strong>lead</strong>, <strong>supporting</strong> and <strong>director</strong> for later analysis.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dropped_dummies</span> <span class="o">=</span> <span class="n">final_dataset_wo_dir</span><span class="p">[[</span><span class="s">'lead'</span><span class="p">,</span> <span class="s">'supporting'</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dropped_dummies</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lead</th>
      <th>supporting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom Hanks</td>
      <td>Tim Allen</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">final_dataset_wo_dir</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'lead'</span><span class="p">,</span> <span class="s">'supporting'</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dummies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>id</th>
      <th>budget</th>
      <th>revenue</th>
      <th>runtime</th>
      <th>vote_average</th>
      <th>vote_count</th>
      <th>belongs_to_collection</th>
      <th>Action</th>
      <th>Adventure</th>
      <th>Animation</th>
      <th>Aniplex</th>
      <th>BROSTA TV</th>
      <th>Carousel Productions</th>
      <th>Comedy</th>
      <th>Crime</th>
      <th>Documentary</th>
      <th>Drama</th>
      <th>Family</th>
      <th>Fantasy</th>
      <th>Foreign</th>
      <th>GoHands</th>
      <th>History</th>
      <th>Horror</th>
      <th>Mardock Scramble Production Committee</th>
      <th>Music</th>
      <th>Mystery</th>
      <th>Odyssey Media</th>
      <th>Pulser Productions</th>
      <th>Rogue State</th>
      <th>Romance</th>
      <th>Science Fiction</th>
      <th>Sentai Filmworks</th>
      <th>TV Movie</th>
      <th>Telescene Film Group Productions</th>
      <th>The Cartel</th>
      <th>Thriller</th>
      <th>Vision View Entertainment</th>
      <th>War</th>
      <th>Western</th>
      <th>dir_count</th>
      <th>lead_Aaron Eckhart</th>
      <th>lead_Aaron Taylor-Johnson</th>
      <th>lead_Adam Brody</th>
      <th>lead_Adam Sandler</th>
      <th>lead_Adrien Brody</th>
      <th>lead_Adrienne Barbeau</th>
      <th>lead_Aileen Quinn</th>
      <th>lead_Al Pacino</th>
      <th>lead_Alan Arkin</th>
      <th>lead_Alec Baldwin</th>
      <th>lead_Alex D. Linz</th>
      <th>lead_Alex Frost</th>
      <th>lead_Alex Pettyfer</th>
      <th>lead_Alexa PenaVega</th>
      <th>lead_Alexander Skarsgård</th>
      <th>lead_Ali Larter</th>
      <th>lead_Alison Lohman</th>
      <th>lead_Alyson Hannigan</th>
      <th>lead_Amanda Bynes</th>
      <th>lead_Amanda Seyfried</th>
      <th>lead_Amber Tamblyn</th>
      <th>lead_Amber Valletta</th>
      <th>lead_Amy Adams</th>
      <th>lead_Amy Schumer</th>
      <th>lead_Andrew Dice Clay</th>
      <th>lead_Andrew Garfield</th>
      <th>lead_Andy García</th>
      <th>lead_Andy Samberg</th>
      <th>lead_Angelina Jolie</th>
      <th>lead_Anika Noni Rose</th>
      <th>lead_Anna Faris</th>
      <th>lead_Anna Kendrick</th>
      <th>lead_Anne Hathaway</th>
      <th>lead_Ansel Elgort</th>
      <th>lead_Anthony Hopkins</th>
      <th>lead_Anthony Perkins</th>
      <th>lead_Anthony Rapp</th>
      <th>lead_Antonio Banderas</th>
      <th>lead_Arnold Schwarzenegger</th>
      <th>lead_Arthur Hill</th>
      <th>lead_Asa Butterfield</th>
      <th>lead_Ashley Judd</th>
      <th>lead_Ashton Kutcher</th>
      <th>lead_Aubrey Peeples</th>
      <th>lead_Audrey Hepburn</th>
      <th>lead_Audrey Tautou</th>
      <th>lead_Auli'i Cravalho</th>
      <th>lead_Barbara Harris</th>
      <th>lead_Barney Clark</th>
      <th>lead_Barret Oliver</th>
      <th>lead_Barrie Ingham</th>
      <th>lead_Ben Affleck</th>
      <th>lead_Ben Kingsley</th>
      <th>lead_Ben Stiller</th>
      <th>lead_Ben Whishaw</th>
      <th>lead_Benedict Cumberbatch</th>
      <th>lead_Benicio del Toro</th>
      <th>lead_Benjamin Bratt</th>
      <th>lead_Benjamin Walker</th>
      <th>lead_Bill Murray</th>
      <th>lead_Bill Nighy</th>
      <th>lead_Bill Pullman</th>
      <th>lead_Billy Bob Thornton</th>
      <th>lead_Billy Campbell</th>
      <th>lead_Billy Crystal</th>
      <th>lead_Björk</th>
      <th>lead_Blake Jenner</th>
      <th>lead_Blake Lively</th>
      <th>lead_Bob Hoskins</th>
      <th>lead_Bob Newhart</th>
      <th>lead_Bobby Campo</th>
      <th>lead_Bobby Driscoll</th>
      <th>lead_Bodil Jørgensen</th>
      <th>lead_Brad Davis</th>
      <th>lead_Brad Pitt</th>
      <th>lead_Bradley Cooper</th>
      <th>lead_Brady Corbet</th>
      <th>lead_Brandon Lee</th>
      <th>lead_Brandon Routh</th>
      <th>lead_Breckin Meyer</th>
      <th>lead_Brendan Fraser</th>
      <th>lead_Brenton Thwaites</th>
      <th>lead_Brian Bedford</th>
      <th>lead_Brian O'Halloran</th>
      <th>lead_Briana Evigan</th>
      <th>lead_Britt Robertson</th>
      <th>lead_Bruce Campbell</th>
      <th>lead_Bruce Dern</th>
      <th>lead_Bruce Reitherman</th>
      <th>lead_Bruce Willis</th>
      <th>lead_Bryan Cranston</th>
      <th>lead_Bryce Dallas Howard</th>
      <th>lead_Burt Lancaster</th>
      <th>lead_Burt Reynolds</th>
      <th>lead_Cameron Diaz</th>
      <th>lead_Camilla Belle</th>
      <th>lead_Carice van Houten</th>
      <th>lead_Carmen Maura</th>
      <th>lead_Carroll Baker</th>
      <th>lead_Cary Elwes</th>
      <th>lead_Cary Grant</th>
      <th>lead_Casper Van Dien</th>
      <th>lead_Cate Blanchett</th>
      <th>lead_Catherine Deneuve</th>
      <th>lead_Catherine Zeta-Jones</th>
      <th>lead_Cecilia Roth</th>
      <th>lead_Chadwick Boseman</th>
      <th>lead_Chang Chen</th>
      <th>lead_Channing Tatum</th>
      <th>lead_Charles Bronson</th>
      <th>lead_Charlie Chaplin</th>
      <th>lead_Charlie Hunnam</th>
      <th>lead_Charlie Sheen</th>
      <th>lead_Charlie Tahan</th>
      <th>lead_Charlize Theron</th>
      <th>lead_Chevy Chase</th>
      <th>lead_Chow Yun-fat</th>
      <th>lead_Chris Evans</th>
      <th>lead_Chris Hemsworth</th>
      <th>lead_Chris O'Donnell</th>
      <th>lead_Chris Pine</th>
      <th>lead_Chris Riggi</th>
      <th>lead_Chris Rock</th>
      <th>lead_Chris Tucker</th>
      <th>lead_Christian Bale</th>
      <th>lead_Christian Slater</th>
      <th>lead_Christina Applegate</th>
      <th>lead_Christina Ricci</th>
      <th>lead_Christine Hargreaves</th>
      <th>lead_Christoph Waltz</th>
      <th>lead_Christopher Guest</th>
      <th>lead_Christopher Lambert</th>
      <th>lead_Christopher Plummer</th>
      <th>lead_Christopher Reeve</th>
      <th>lead_Christopher Walken</th>
      <th>lead_Cillian Murphy</th>
      <th>lead_Claire Danes</th>
      <th>lead_Claire Trevor</th>
      <th>lead_Clark Gable</th>
      <th>lead_Cleavon Little</th>
      <th>lead_Clint Eastwood</th>
      <th>lead_Clive Owen</th>
      <th>lead_Colin Farrell</th>
      <th>lead_Colin Firth</th>
      <th>lead_Craig T. Nelson</th>
      <th>lead_Craig Wasson</th>
      <th>lead_Cuba Gooding Jr.</th>
      <th>lead_Daisy Ridley</th>
      <th>lead_Dakota Blue Richards</th>
      <th>lead_Dakota Johnson</th>
      <th>lead_Dan Aykroyd</th>
      <th>lead_Dane DeHaan</th>
      <th>lead_Daniel Brühl</th>
      <th>lead_Daniel Craig</th>
      <th>lead_Daniel Day-Lewis</th>
      <th>lead_Daniel Radcliffe</th>
      <th>lead_Danny Aiello</th>
      <th>lead_Danny DeVito</th>
      <th>lead_Danny McBride</th>
      <th>lead_Danny Trejo</th>
      <th>lead_Dany Boon</th>
      <th>lead_David Arquette</th>
      <th>lead_David Duchovny</th>
      <th>lead_David Emge</th>
      <th>lead_David Naughton</th>
      <th>lead_David Niven</th>
      <th>lead_David Strathairn</th>
      <th>lead_Debra Winger</th>
      <th>lead_Dee Wallace</th>
      <th>lead_Demi Moore</th>
      <th>lead_Demián Bichir</th>
      <th>lead_Dennis Quaid</th>
      <th>lead_Denzel Washington</th>
      <th>lead_Derek Jacobi</th>
      <th>lead_Derek Luke</th>
      <th>lead_Dev Patel</th>
      <th>lead_Diana Ross</th>
      <th>lead_Dominic Cooper</th>
      <th>lead_Dominique Pinon</th>
      <th>lead_Donald Pleasence</th>
      <th>lead_Donald Sutherland</th>
      <th>lead_Drew Barrymore</th>
      <th>lead_Duane Jones</th>
      <th>lead_Dustin Hoffman</th>
      <th>lead_Dwayne Johnson</th>
      <th>lead_Ed Harris</th>
      <th>lead_Eddie Griffin</th>
      <th>lead_Eddie Murphy</th>
      <th>lead_Eddie Redmayne</th>
      <th>lead_Edmund Gwenn</th>
      <th>lead_Eduardo Noriega</th>
      <th>lead_Edward Norton</th>
      <th>lead_Eli Marienthal</th>
      <th>lead_Elijah Wood</th>
      <th>lead_Elisha Cuthbert</th>
      <th>lead_Elizabeth Berkley</th>
      <th>lead_Elizabeth Hurley</th>
      <th>lead_Elizabeth Taylor</th>
      <th>lead_Ellar Coltrane</th>
      <th>lead_Elle Fanning</th>
      <th>lead_Ellen Burstyn</th>
      <th>lead_Ellen Page</th>
      <th>lead_Emile Hirsch</th>
      <th>lead_Emilio Estevez</th>
      <th>lead_Emily Barclay</th>
      <th>lead_Emily Blunt</th>
      <th>lead_Emily Browning</th>
      <th>lead_Emily Watson</th>
      <th>lead_Emma Thompson</th>
      <th>...</th>
      <th>supporting_Peter Sellers</th>
      <th>supporting_Phil Harris</th>
      <th>supporting_Phil Hartman</th>
      <th>supporting_Philip Seymour Hoffman</th>
      <th>supporting_Phoebe Cates</th>
      <th>supporting_Pierce Brosnan</th>
      <th>supporting_Piper Laurie</th>
      <th>supporting_Piper Perabo</th>
      <th>supporting_Polly Adams</th>
      <th>supporting_Powers Boothe</th>
      <th>supporting_Priscilla Presley</th>
      <th>supporting_Queen Latifah</th>
      <th>supporting_Quentin Tarantino</th>
      <th>supporting_Quinton Aaron</th>
      <th>supporting_Rachel Griffiths</th>
      <th>supporting_Rachel McAdams</th>
      <th>supporting_Rachel Nichols</th>
      <th>supporting_Rachel Weisz</th>
      <th>supporting_Radha Mitchell</th>
      <th>supporting_Raini Rodriguez</th>
      <th>supporting_Ralph Fiennes</th>
      <th>supporting_Ralph Macchio</th>
      <th>supporting_Rami Malek</th>
      <th>supporting_Randy Quaid</th>
      <th>supporting_Raoul Bova</th>
      <th>supporting_Raquel Castro</th>
      <th>supporting_Raquel Welch</th>
      <th>supporting_Ray Allen</th>
      <th>supporting_Ray Liotta</th>
      <th>supporting_Ray Winstone</th>
      <th>supporting_Ray Wise</th>
      <th>supporting_Raymond J. Barry</th>
      <th>supporting_Rebecca Hall</th>
      <th>supporting_Reese Witherspoon</th>
      <th>supporting_Regina Hall</th>
      <th>supporting_Rei Sakuma</th>
      <th>supporting_Rene Russo</th>
      <th>supporting_Renée Zellweger</th>
      <th>supporting_Rhys Ifans</th>
      <th>supporting_Richard Attenborough</th>
      <th>supporting_Richard Basehart</th>
      <th>supporting_Richard Beymer</th>
      <th>supporting_Richard Burton</th>
      <th>supporting_Richard Dreyfuss</th>
      <th>supporting_Richard Gere</th>
      <th>supporting_Richard Kind</th>
      <th>supporting_Rick Moranis</th>
      <th>supporting_River Phoenix</th>
      <th>supporting_Rob Brown</th>
      <th>supporting_Robert Carlyle</th>
      <th>supporting_Robert De Niro</th>
      <th>supporting_Robert Downey Jr.</th>
      <th>supporting_Robert Duvall</th>
      <th>supporting_Robert Englund</th>
      <th>supporting_Robert Hoffman</th>
      <th>supporting_Robert Pattinson</th>
      <th>supporting_Robert Redford</th>
      <th>supporting_Robert Sean Leonard</th>
      <th>supporting_Robert Shaw</th>
      <th>supporting_Robert Walker</th>
      <th>supporting_Roberto Benigni</th>
      <th>supporting_Robin Shou</th>
      <th>supporting_Robin Tunney</th>
      <th>supporting_Robin Williams</th>
      <th>supporting_Robin Wright</th>
      <th>supporting_Rochelle Davis</th>
      <th>supporting_Rod Taylor</th>
      <th>supporting_Rodney Dangerfield</th>
      <th>supporting_Roger B. Smith</th>
      <th>supporting_Ron Howard</th>
      <th>supporting_Ron Perlman</th>
      <th>supporting_Ronee Blakley</th>
      <th>supporting_Rooney Mara</th>
      <th>supporting_Rory Cochrane</th>
      <th>supporting_Rosamund Pike</th>
      <th>supporting_Rosanna Arquette</th>
      <th>supporting_Rosario Dawson</th>
      <th>supporting_Rosario Flores</th>
      <th>supporting_Rose Byrne</th>
      <th>supporting_Rufus Sewell</th>
      <th>supporting_Rupert Grint</th>
      <th>supporting_Russell Brand</th>
      <th>supporting_Russell Crowe</th>
      <th>supporting_Rutger Hauer</th>
      <th>supporting_Ryan Gosling</th>
      <th>supporting_Ryan Guzman</th>
      <th>supporting_Ryan Reynolds</th>
      <th>supporting_Sacha Baron Cohen</th>
      <th>supporting_Saffron Burrows</th>
      <th>supporting_Sally Field</th>
      <th>supporting_Salma Hayek</th>
      <th>supporting_Sam Neill</th>
      <th>supporting_Sam Rockwell</th>
      <th>supporting_Sam Worthington</th>
      <th>supporting_Samaire Armstrong</th>
      <th>supporting_Samuel L. Jackson</th>
      <th>supporting_Sandra Bullock</th>
      <th>supporting_Sarah Berry</th>
      <th>supporting_Sarah Michelle Gellar</th>
      <th>supporting_Sarah Roemer</th>
      <th>supporting_Sarita Choudhury</th>
      <th>supporting_Scarlett Johansson</th>
      <th>supporting_Scott Bakula</th>
      <th>supporting_Scott Caan</th>
      <th>supporting_Scott MacDonald</th>
      <th>supporting_Scott Speedman</th>
      <th>supporting_Sean Bean</th>
      <th>supporting_Sean Connery</th>
      <th>supporting_Sean Penn</th>
      <th>supporting_Sean Young</th>
      <th>supporting_Seann William Scott</th>
      <th>supporting_Sebastian Koch</th>
      <th>supporting_Selma Blair</th>
      <th>supporting_Seth Green</th>
      <th>supporting_Seth Rogen</th>
      <th>supporting_Shailene Woodley</th>
      <th>supporting_Shane West</th>
      <th>supporting_Shannyn Sossamon</th>
      <th>supporting_Shantel VanSanten</th>
      <th>supporting_Sharon Stone</th>
      <th>supporting_Shawnee Smith</th>
      <th>supporting_Shelley Duvall</th>
      <th>supporting_Sheri Moon Zombie</th>
      <th>supporting_Shia LaBeouf</th>
      <th>supporting_Shirley MacLaine</th>
      <th>supporting_Shu Qi</th>
      <th>supporting_Sienna Guillory</th>
      <th>supporting_Sienna Miller</th>
      <th>supporting_Sigourney Weaver</th>
      <th>supporting_Simon Chandler</th>
      <th>supporting_Sofía Vergara</th>
      <th>supporting_Sondra Locke</th>
      <th>supporting_Sonja Smits</th>
      <th>supporting_Sophia Myles</th>
      <th>supporting_Sophie Marceau</th>
      <th>supporting_Soren Fulton</th>
      <th>supporting_Spencer Breslin</th>
      <th>supporting_Stacy Keach</th>
      <th>supporting_Stanley Tucci</th>
      <th>supporting_Stefanie Scott</th>
      <th>supporting_Stephen Baldwin</th>
      <th>supporting_Stephen Rea</th>
      <th>supporting_Sterling Holloway</th>
      <th>supporting_Steve Carell</th>
      <th>supporting_Steve Coogan</th>
      <th>supporting_Steve Martin</th>
      <th>supporting_Steve Zahn</th>
      <th>supporting_Steven Bauer</th>
      <th>supporting_Sue Lyon</th>
      <th>supporting_Sung Kang</th>
      <th>supporting_Susan George</th>
      <th>supporting_Susan Sarandon</th>
      <th>supporting_Sylvester Stallone</th>
      <th>supporting_Sô Yamamura</th>
      <th>supporting_T.R. Knight</th>
      <th>supporting_Takeshi Kaneshiro</th>
      <th>supporting_Talia Shire</th>
      <th>supporting_Tara Morice</th>
      <th>supporting_Taraji P. Henson</th>
      <th>supporting_Taylor Dooley</th>
      <th>supporting_Taylor Kitsch</th>
      <th>supporting_Taylor Momsen</th>
      <th>supporting_Tencho Gyalpo</th>
      <th>supporting_Terence Stamp</th>
      <th>supporting_Teresa Palmer</th>
      <th>supporting_Teri Polo</th>
      <th>supporting_Terrence Howard</th>
      <th>supporting_Terry Alexander</th>
      <th>supporting_Thandie Newton</th>
      <th>supporting_Theo James</th>
      <th>supporting_Thomas Haden Church</th>
      <th>supporting_Thomas Kretschmann</th>
      <th>supporting_Thora Birch</th>
      <th>supporting_Tim Allen</th>
      <th>supporting_Tim Matheson</th>
      <th>supporting_Tim Robbins</th>
      <th>supporting_Tim Roth</th>
      <th>supporting_Timothy Olyphant</th>
      <th>supporting_Tina Fey</th>
      <th>supporting_Tina Turner</th>
      <th>supporting_Tobey Maguire</th>
      <th>supporting_Toby Kebbell</th>
      <th>supporting_Tom Cruise</th>
      <th>supporting_Tom Glynn-Carney</th>
      <th>supporting_Tom Hanks</th>
      <th>supporting_Tom Hardy</th>
      <th>supporting_Tom Hulce</th>
      <th>supporting_Tom Sizemore</th>
      <th>supporting_Tom Wilkinson</th>
      <th>supporting_Tommy Lee Jones</th>
      <th>supporting_Toni Collette</th>
      <th>supporting_Tony Curtis</th>
      <th>supporting_Tony Revolori</th>
      <th>supporting_Tracy Morgan</th>
      <th>supporting_Tuesday Knight</th>
      <th>supporting_Tye Sheridan</th>
      <th>supporting_Tyler Hoechlin</th>
      <th>supporting_Tyrese Gibson</th>
      <th>supporting_Téa Leoni</th>
      <th>supporting_Uma Thurman</th>
      <th>supporting_Unax Ugalde</th>
      <th>supporting_Val Bettin</th>
      <th>supporting_Val Kilmer</th>
      <th>supporting_Vanessa Bauche</th>
      <th>supporting_Vanessa Lachey</th>
      <th>supporting_Vera Farmiga</th>
      <th>supporting_Vera Miles</th>
      <th>supporting_Verna Bloom</th>
      <th>supporting_Verna Felton</th>
      <th>supporting_Viggo Mortensen</th>
      <th>supporting_Vin Diesel</th>
      <th>supporting_Vince Vaughn</th>
      <th>supporting_Vincent Cassel</th>
      <th>supporting_Vincent D'Onofrio</th>
      <th>supporting_Vincent Piazza</th>
      <th>supporting_Ving Rhames</th>
      <th>supporting_Virginia Cherrill</th>
      <th>supporting_Virginia Madsen</th>
      <th>supporting_Vladimir Kulich</th>
      <th>supporting_Vladimir Menshov</th>
      <th>supporting_Walter Huston</th>
      <th>supporting_Wayne Newton</th>
      <th>supporting_Wendy Raquel Robinson</th>
      <th>supporting_Wentworth Miller</th>
      <th>supporting_Wesley Snipes</th>
      <th>supporting_Whitney Houston</th>
      <th>supporting_Will Ferrell</th>
      <th>supporting_Will Forte</th>
      <th>supporting_Will Sasso</th>
      <th>supporting_Will Smith</th>
      <th>supporting_Willem Dafoe</th>
      <th>supporting_William Atherton</th>
      <th>supporting_William Baldwin</th>
      <th>supporting_William Forsythe</th>
      <th>supporting_William H. Macy</th>
      <th>supporting_William Holden</th>
      <th>supporting_William Hurt</th>
      <th>supporting_Winona Ryder</th>
      <th>supporting_Woody Harrelson</th>
      <th>supporting_Yaphet Kotto</th>
      <th>supporting_Yasiin Bey</th>
      <th>supporting_Yuriko Ishida</th>
      <th>supporting_Zac Efron</th>
      <th>supporting_Zach Galifianakis</th>
      <th>supporting_Zachary Quinto</th>
      <th>supporting_Zoe Saldana</th>
      <th>supporting_Zooey Deschanel</th>
      <th>supporting_Zoë Bell</th>
      <th>supporting_Zuleikha Robinson</th>
      <th>supporting_Óscar Jaenada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Toy Story</td>
      <td>862</td>
      <td>30000000.0</td>
      <td>373554033.0</td>
      <td>81.0</td>
      <td>7.7</td>
      <td>5415.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jumanji</td>
      <td>8844</td>
      <td>65000000.0</td>
      <td>262797249.0</td>
      <td>104.0</td>
      <td>6.9</td>
      <td>2413.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Heat</td>
      <td>949</td>
      <td>60000000.0</td>
      <td>187436818.0</td>
      <td>170.0</td>
      <td>7.7</td>
      <td>1886.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Sudden Death</td>
      <td>9091</td>
      <td>35000000.0</td>
      <td>64350171.0</td>
      <td>106.0</td>
      <td>5.5</td>
      <td>174.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>GoldenEye</td>
      <td>710</td>
      <td>58000000.0</td>
      <td>352194034.0</td>
      <td>130.0</td>
      <td>6.6</td>
      <td>1194.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1847 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">directors</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">directors</span><span class="p">[</span><span class="s">"value"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">unique_dir_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">directors</span><span class="o">.</span><span class="n">director</span><span class="p">))</span>
<span class="n">master</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">unique_dir_names</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">directors</span><span class="o">.</span><span class="nb">id</span><span class="p">)):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">directors</span><span class="p">[</span><span class="n">directors</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span> <span class="o">==</span> <span class="n">n</span><span class="p">]</span>
    <span class="n">pivoted</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">"id"</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">"director"</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">"value"</span><span class="p">)</span>
    <span class="n">master</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pivoted</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">master</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">master</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="n">dummies</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s">'index'</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s">'id'</span><span class="p">)</span>
</code></pre></div></div>

<p>Finally, I’ll drop the first director as a reference, as well as the <strong>index</strong> and <strong>id</strong> columns used for joining. The director I am dropping is “Aaron Seltzer”, which is worth noting for when I interpret the coefficients.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"index"</span><span class="p">,</span> <span class="s">"Aaron Seltzer"</span><span class="p">,</span> <span class="s">"dir_count"</span><span class="p">,</span> <span class="s">"title"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">master</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"director_dummies.csv"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="pre-processing">Pre-processing</h3>
<p>Since the final product of this modelling is to produce a Flask app that allows someone to input factors about a film before it’s produced to get the rating and the revenue generated, some features will have to be dropped. For example, a user would not know the <em>vote_count</em> before the film is created. Some of the features I am removing are the most correlated with the response variable so I will be losing some of the predictive power.</p>

<p>I’ll begin by defining my train/test split. Then I’ll standardise the remaining predictive variables since it’s good practice for working with linear regressions. I’ll fit and transform the scaling on my training set and transform on my testing set.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">"vote_average"</span><span class="p">,</span> <span class="s">"revenue"</span><span class="p">,</span> <span class="s">"vote_count"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">vote_average</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Length of training sets:"</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Length of testing sets:"</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Length of training sets: 1296 556
Length of testing sets: 1296 556
</code></pre></div></div>

<h3 id="modelling">Modelling</h3>

<h4 id="baseline-score">Baseline score</h4>
<p>I need a baseline score with which to compare the scores for all my models moving forward. This score will represent the score one would get if they were just to predict the mean value for <em>y</em>. If my model outperforms this score, I know it is doing well.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred_mean</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_train</span><span class="o">.</span><span class="n">mean</span><span class="p">()]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Baseline score RMSE: "</span><span class="p">,</span><span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_mean</span><span class="p">))))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Baseline score RMSE:  0.83
</code></pre></div></div>

<p>The baseline score is an RMSE of 0.83, meaning that the predicted score is within 0.83 of a mark out of 10. I’ll use this is a benchmark as to the performance of my models.</p>

<p>Ultimately, I will be choosing the model that has the best cross-validated score of all as this will be the one that generalises well. I will also take into account the training and test scores, since these will indicate over or underfitting.</p>

<h4 id="function-to-generate-model-scores">Function to generate model scores</h4>
<p>Since I’ll be trying out many different models, I’ll build a function that returns all the information for efficiency. I’ll create one function for simple models and another for models utilising regularisation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Function to return simple model metrics</span>
<span class="k">def</span> <span class="nf">get_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">parametric</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="s">"""This function takes the train-test splits as arguments, as well as the algorithm 
    being used, and returns the training score, the test score (both RMSE), the 
    cross-validated scores and the mean cross-validated score. It also returns the appropriate 
    feature importances depending on whether the optional argument 'parametric' is equal to 
    True or False."""</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">train_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">'Training score'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">train_pred</span><span class="p">))))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Testing RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">))))</span>
    <span class="n">cv_scores</span> <span class="o">=</span> <span class="o">-</span><span class="n">ms</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">'neg_mean_squared_error'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Cross-validated RMSEs:'</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Mean cross-validated RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">))))</span>
    
    <span class="k">if</span> <span class="n">parametric</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">))),</span> 
                 <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Feature'</span><span class="p">,</span> <span class="s">'Coef'</span><span class="p">,</span> <span class="s">'Abs Coef'</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Abs Coef'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)),</span> 
                 <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Feature'</span><span class="p">,</span> <span class="s">'Importance'</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Importance'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Function to return regularised model metrics</span>
<span class="k">def</span> <span class="nf">regularised_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">grid_params</span><span class="p">,</span> <span class="n">parametric</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="s">"""This function takes the train-test splits as arguments, as well as the algorithm being 
    used and the parameters, and returns the best cross-validated training score, the test 
    score, the best performing model and it's parameters, and the feature importances."""</span>
    
    <span class="n">gridsearch</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">model</span><span class="p">,</span>
                              <span class="n">grid_params</span><span class="p">,</span>
                              <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s">'neg_mean_squared_error'</span><span class="p">)</span>
    
    <span class="n">gridsearch</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Best parameters:'</span><span class="p">,</span> <span class="n">gridsearch</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Cross-validated score on test data:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gridsearch</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)))</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="n">gridsearch</span><span class="o">.</span><span class="n">best_estimator_</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Testing RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))))</span>
    
    <span class="k">if</span> <span class="n">parametric</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">best_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">))),</span> 
                 <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Feature'</span><span class="p">,</span> <span class="s">'Coef'</span><span class="p">,</span> <span class="s">'Abs Coef'</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Abs Coef'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">best_model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)),</span> 
                 <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Feature'</span><span class="p">,</span> <span class="s">'Importance'</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Importance'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">best_model</span>
</code></pre></div></div>

<h4 id="linear-regression">Linear regression</h4>
<h5 id="simple">Simple</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lm_simple</span> <span class="o">=</span> <span class="n">get_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">lm</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">())</span>
<span class="n">lm_simple</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Training score 0.16
Testing RMSE: 28456150374210.60
Cross-validated RMSEs: [8.93832333e+12 2.50381131e+13 3.51881686e+13 1.54939005e+13
 2.66140868e+13]
Mean cross-validated RMSE: 24055679197777.84
                          Feature          Coef      Abs Coef
287             lead_Aileen Quinn  1.236628e+13  1.236628e+13
563             lead_J.J. Johnson  7.765516e+12  7.765516e+12
98                Jason Friedberg -7.324091e+12  7.324091e+12
33                Brian Helgeland -7.206760e+12  7.206760e+12
595        lead_Jason Schwartzman -5.903357e+12  5.903357e+12
1807   supporting_Olivia Williams  5.676954e+12  5.676954e+12
276                    The Cartel  4.742263e+12  4.742263e+12
44                 Clyde Geronimi -4.666503e+12  4.666503e+12
1954  supporting_Shannyn Sossamon  4.071398e+12  4.071398e+12
284             lead_Adam Sandler  4.013993e+12  4.013993e+12





LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)
</code></pre></div></div>

<p>The test score and mean cross-validated scores are both terrible, way above baseline, and the OK training score indicates huge overfitting. This is not too surprising with such a simple model, so introducing some regularisation should help.</p>

<h5 id="regularised---ridge">Regularised - Ridge</h5>
<p>For every model I use regularisation on, I will get a list of the parameters so I can select which ones to gridsearch.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ridge</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">Ridge</span><span class="p">()</span>
<span class="nb">list</span><span class="p">(</span><span class="n">ridge</span><span class="o">.</span><span class="n">get_params</span><span class="p">())</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['alpha',
 'copy_X',
 'fit_intercept',
 'max_iter',
 'normalize',
 'random_state',
 'solver',
 'tol']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ridge_params</span> <span class="o">=</span> <span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s">'fit_intercept'</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
               <span class="s">'solver'</span><span class="p">:</span> <span class="p">[</span><span class="s">'auto'</span><span class="p">,</span> <span class="s">'svd'</span><span class="p">,</span> <span class="s">'cholesky'</span><span class="p">,</span> <span class="s">'lsqr'</span><span class="p">,</span> <span class="s">'sparse_cg'</span><span class="p">,</span> <span class="s">'sag'</span><span class="p">,</span> <span class="s">'saga'</span><span class="p">]}</span>

<span class="n">ridge_model</span> <span class="o">=</span> <span class="n">regularised_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">ridge</span><span class="p">,</span> <span class="n">ridge_params</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fitting 5 folds for each of 140 candidates, totalling 700 fits


[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:   34.3s
[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed:  3.3min
[Parallel(n_jobs=-1)]: Done 442 tasks      | elapsed:  8.1min
[Parallel(n_jobs=-1)]: Done 700 out of 700 | elapsed:  9.6min finished


Best parameters: {'alpha': 2154.4346900318865, 'fit_intercept': True, 'solver': 'sparse_cg'}
Cross-validated score on test data: 0.20
Testing RMSE: 0.73
                      Feature      Coef  Abs Coef
247                   runtime  0.057142  0.057142
258                     Drama  0.035586  0.035586
255                    Comedy -0.035077  0.035077
246                    budget -0.034000  0.034000
249                    Action -0.025765  0.025765
25               Billy Wilder  0.024681  0.024681
468         lead_Eddie Murphy -0.024559  0.024559
187         Quentin Tarantino  0.024217  0.024217
41          Christopher Nolan  0.024203  0.024203
1594  supporting_Katie Holmes -0.021963  0.021963
</code></pre></div></div>

<p>The cross-validated training score and the test score here looks a lot more promising - although the model is overfitting, the test score is still better than baseline. The coefficients make a bit more sense, but I’ll see if the other models reflect this.</p>

<h5 id="regularised---lasso">Regularised - Lasso</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lasso</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">Lasso</span><span class="p">()</span>
<span class="nb">list</span><span class="p">(</span><span class="n">lasso</span><span class="o">.</span><span class="n">get_params</span><span class="p">())</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['alpha',
 'copy_X',
 'fit_intercept',
 'max_iter',
 'normalize',
 'positive',
 'precompute',
 'random_state',
 'selection',
 'tol',
 'warm_start']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lasso_params</span> <span class="o">=</span> <span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s">'fit_intercept'</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]}</span>

<span class="n">lasso_model</span> <span class="o">=</span> <span class="n">regularised_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">lasso</span><span class="p">,</span> <span class="n">lasso_params</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fitting 5 folds for each of 20 candidates, totalling 100 fits


[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:   23.2s


Best parameters: {'alpha': 0.07742636826811278, 'fit_intercept': True}
Cross-validated score on test data: 0.18
Testing RMSE: 0.75
                            Feature      Coef  Abs Coef
247                         runtime  0.204818  0.204818
246                          budget -0.100973  0.100973
258                           Drama  0.048917  0.048917
255                          Comedy -0.037615  0.037615
249                          Action -0.034441  0.034441
251                       Animation  0.028058  0.028058
25                     Billy Wilder  0.024367  0.024367
468               lead_Eddie Murphy -0.003947  0.003947
41                Christopher Nolan  0.003654  0.003654
1380  supporting_Herbert Grönemeyer  0.000000  0.000000


[Parallel(n_jobs=-1)]: Done 100 out of 100 | elapsed:   27.5s finished
</code></pre></div></div>

<p>The cross-validated training score is better here, although the test score is worse. The coefficients are also similar to the simple linear regression.</p>

<h5 id="regularised---elasticnet">Regularised - ElasticNet</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">elastic</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">ElasticNet</span><span class="p">()</span>
<span class="nb">list</span><span class="p">(</span><span class="n">elastic</span><span class="o">.</span><span class="n">get_params</span><span class="p">())</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['alpha',
 'copy_X',
 'fit_intercept',
 'l1_ratio',
 'max_iter',
 'normalize',
 'positive',
 'precompute',
 'random_state',
 'selection',
 'tol',
 'warm_start']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">elastic_params</span> <span class="o">=</span> <span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                 <span class="s">'l1_ratio'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                 <span class="s">'fit_intercept'</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]}</span>

<span class="n">elastic_model</span> <span class="o">=</span> <span class="n">regularised_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">elastic</span><span class="p">,</span> 
                                          <span class="n">elastic_params</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fitting 5 folds for each of 200 candidates, totalling 1000 fits


[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:   37.9s
[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed:  1.6min
[Parallel(n_jobs=-1)]: Done 442 tasks      | elapsed:  4.6min
[Parallel(n_jobs=-1)]: Done 792 tasks      | elapsed:  5.0min
[Parallel(n_jobs=-1)]: Done 1000 out of 1000 | elapsed:  5.3min finished


Best parameters: {'alpha': 0.07742636826811278, 'fit_intercept': True, 'l1_ratio': 0.25}
Cross-validated score on test data: 0.29
Testing RMSE: 0.68
               Feature      Coef  Abs Coef
247            runtime  0.218141  0.218141
246             budget -0.162801  0.162801
255             Comedy -0.086776  0.086776
25        Billy Wilder  0.074144  0.074144
251          Animation  0.069016  0.069016
258              Drama  0.056174  0.056174
41   Christopher Nolan  0.054816  0.054816
249             Action -0.044436  0.044436
239       Wes Anderson  0.044365  0.044365
187  Quentin Tarantino  0.043444  0.043444
</code></pre></div></div>

<p>The best testing score yet, with less overfitting. All the linear regression models seem to have performed similarly. I’ll see how other models perform now.</p>

<h4 id="tree-models">Tree models</h4>
<h5 id="simple-decision-tree">Simple decision tree</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dt</span> <span class="o">=</span> <span class="n">get_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeRegressor</span><span class="p">(),</span> 
                       <span class="n">parametric</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">dt</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Training score 0.00
Testing RMSE: 0.84
Cross-validated RMSEs: [0.84988687 0.79734114 0.79138703 0.78999536 0.85444556]
Mean cross-validated RMSE: 0.82
                   Feature  Importance
247                runtime    0.214021
246                 budget    0.212694
258                  Drama    0.027402
251              Animation    0.015236
259                 Family    0.015190
260                Fantasy    0.013420
67                Eli Roth    0.011142
250              Adventure    0.011036
272        Science Fiction    0.010173
248  belongs_to_collection    0.008883





DecisionTreeRegressor(criterion='mse', max_depth=None, max_features=None,
           max_leaf_nodes=None, min_impurity_decrease=0.0,
           min_impurity_split=None, min_samples_leaf=1,
           min_samples_split=2, min_weight_fraction_leaf=0.0,
           presort=False, random_state=None, splitter='best')
</code></pre></div></div>

<p>I expected a single decision tree to overfit, and we can see here from the perfect test score that it has. The test score is above the baseline, so I wouldn’t use this model.</p>

<h5 id="random-forest">Random forest</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rf</span> <span class="o">=</span> <span class="n">get_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">(),</span> 
                       <span class="n">parametric</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">rf</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Training score 0.27
Testing RMSE: 0.70
Cross-validated RMSEs: [0.65723342 0.62455729 0.64259098 0.67142504 0.66986168]
Mean cross-validated RMSE: 0.65
                   Feature  Importance
247                runtime    0.225637
246                 budget    0.219449
258                  Drama    0.014884
249                 Action    0.013076
255                 Comedy    0.012790
251              Animation    0.011984
250              Adventure    0.011676
248  belongs_to_collection    0.011356
259                 Family    0.010790
272        Science Fiction    0.009512





RandomForestRegressor(bootstrap=True, criterion='mse', max_depth=None,
           max_features='auto', max_leaf_nodes=None,
           min_impurity_decrease=0.0, min_impurity_split=None,
           min_samples_leaf=1, min_samples_split=2,
           min_weight_fraction_leaf=0.0, n_estimators=10, n_jobs=1,
           oob_score=False, random_state=None, verbose=0, warm_start=False)
</code></pre></div></div>

<p>I believe this to be the best model so far. The cross-validated score is good compared with the cross-validated scores returned from the other models.</p>

<h5 id="gridsearched-random-forest">Gridsearched Random forest</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rrf</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">()</span>
<span class="nb">list</span><span class="p">(</span><span class="n">rrf</span><span class="o">.</span><span class="n">get_params</span><span class="p">())</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['bootstrap',
 'criterion',
 'max_depth',
 'max_features',
 'max_leaf_nodes',
 'min_impurity_decrease',
 'min_impurity_split',
 'min_samples_leaf',
 'min_samples_split',
 'min_weight_fraction_leaf',
 'n_estimators',
 'n_jobs',
 'oob_score',
 'random_state',
 'verbose',
 'warm_start']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rrf_params</span> <span class="o">=</span> <span class="p">{</span><span class="s">'bootstrap'</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
             <span class="s">'max_depth'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
             <span class="s">'min_samples_split'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
             <span class="s">'n_estimators'</span><span class="p">:</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]}</span>

<span class="n">rrf_model</span> <span class="o">=</span> <span class="n">regularised_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">rrf</span><span class="p">,</span> <span class="n">rrf_params</span><span class="p">,</span>
                                     <span class="n">parametric</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fitting 5 folds for each of 150 candidates, totalling 750 fits


[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:   13.6s
[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed:   57.2s
[Parallel(n_jobs=-1)]: Done 442 tasks      | elapsed:  2.3min
[Parallel(n_jobs=-1)]: Done 750 out of 750 | elapsed:  5.0min finished


Best parameters: {'bootstrap': True, 'max_depth': 50.0, 'min_samples_split': 0.01, 'n_estimators': 50}
Cross-validated score on test data: 0.34
Testing RMSE: 0.68
                   Feature  Importance
247                runtime    0.243007
246                 budget    0.232748
258                  Drama    0.018196
251              Animation    0.014074
249                 Action    0.011856
264                 Horror    0.011726
259                 Family    0.010169
255                 Comedy    0.009754
250              Adventure    0.009498
248  belongs_to_collection    0.007684
</code></pre></div></div>

<p>I expected this model to give one of the best performances, so I am not surprised to see it give the best cross-validated score so far. Although the test score isn’t too far off that of the simple random forest, this is the best model so far.</p>

<h5 id="bagged-decision-trees">Bagged decision trees</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bagdt</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">BaggingRegressor</span><span class="p">()</span>
<span class="n">bagdt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Training RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">bagdt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)))))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Testing RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">bagdt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))))</span>
<span class="n">cv_scores</span> <span class="o">=</span> <span class="o">-</span><span class="n">ms</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">bagdt</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">'neg_mean_squared_error'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Cross-validated RMSEs:'</span><span class="p">,</span> <span class="n">cv_scores</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Mean cross-validated RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Training RMSE: 0.28
Testing RMSE: 0.72
Cross-validated RMSEs: [0.44400885 0.43938494 0.3979722  0.473639   0.46053475]
Mean cross-validated RMSE: 0.44
</code></pre></div></div>

<p>This performs very well, although the gridsearched random forest outperforms it.</p>

<h4 id="support-vector-machine">Support Vector Machine</h4>
<h5 id="linearsvr">LinearSVR</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lin</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">LinearSVR</span><span class="p">()</span> 

<span class="n">lin_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'C'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="s">'loss'</span><span class="p">:</span> <span class="p">[</span><span class="s">'epsilon_insensitive'</span><span class="p">,</span><span class="s">'squared_epsilon_insensitive'</span><span class="p">],</span>
    <span class="s">'fit_intercept'</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">],</span>
    <span class="s">'max_iter'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">lin_model</span> <span class="o">=</span> <span class="n">regularised_model_metrics</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">lin</span><span class="p">,</span> <span class="n">lin_params</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fitting 5 folds for each of 20 candidates, totalling 100 fits


[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:    9.9s
[Parallel(n_jobs=-1)]: Done 100 out of 100 | elapsed:  1.5min finished


Best parameters: {'C': 0.001, 'fit_intercept': True, 'loss': 'epsilon_insensitive', 'max_iter': 1000}
Cross-validated score on test data: 76.13
Testing RMSE: 5.23
                              Feature          Coef      Abs Coef
179                    Peter Farrelly -2.351553e-15  2.351553e-15
793                  lead_Naomi Watts  1.901257e-15  1.901257e-15
90                     Hayao Miyazaki -1.775381e-15  1.775381e-15
52                      David Frankel  1.720209e-15  1.720209e-15
27                     Bobby Farrelly  1.552279e-15  1.552279e-15
92                        J.J. Abrams  1.449619e-15  1.449619e-15
1148  supporting_Catherine Zeta-Jones  1.289997e-15  1.289997e-15
1900        supporting_Robin Williams  1.251860e-15  1.251860e-15
67                           Eli Roth  1.186930e-15  1.186930e-15
102               Jean-Jacques Annaud  1.105900e-15  1.105900e-15
</code></pre></div></div>

<p>The scores here are terrible. This is my first foray into support vector machines, and I may not be optimising them correctly. However these scores plus the performance running them and the coefficients returned makes me feel they may not be the most appropriate models for this scenario.</p>

<h5 id="rbf">RBF</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rbf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">'rbf'</span><span class="p">)</span>

<span class="n">rbf_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'C'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="s">'gamma'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="s">'kernel'</span><span class="p">:</span> <span class="p">[</span><span class="s">'rbf'</span><span class="p">]}</span>

<span class="n">rbf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">rbf</span><span class="p">,</span> <span class="n">rbf_params</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s">'neg_mean_squared_error'</span><span class="p">)</span>
<span class="n">rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Best parameters:'</span><span class="p">,</span> <span class="n">rbf</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Cross-validated Training RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">rbf</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Testing RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rbf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fitting 5 folds for each of 25 candidates, totalling 125 fits


[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:  1.0min
[Parallel(n_jobs=-1)]: Done 125 out of 125 | elapsed:  3.0min finished


Best parameters: {'C': 1.0, 'gamma': 0.0001, 'kernel': 'rbf'}
Cross-validated Training RMSE: 0.14
Testing RMSE: 0.76
</code></pre></div></div>

<p>This gives by far the best cross-validated train score - although the test score isn’t the best, the model obviously generalises well.</p>

<h5 id="poly">Poly</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poly</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">'poly'</span><span class="p">)</span>

<span class="n">poly_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'C'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="s">'gamma'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="s">'degree'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]}</span>

<span class="n">poly</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">poly_params</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s">'neg_mean_squared_error'</span><span class="p">)</span>
<span class="n">poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Best parameters:'</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Cross-validated Training RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Testing RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fitting 5 folds for each of 100 candidates, totalling 500 fits


[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:  1.0min
[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed:  4.4min
[Parallel(n_jobs=-1)]: Done 442 tasks      | elapsed: 10.2min
[Parallel(n_jobs=-1)]: Done 500 out of 500 | elapsed: 11.5min finished


Best parameters: {'C': 0.09444444444444444, 'degree': 2, 'gamma': 0.01291549665014884}
Cross-validated Training RMSE: 0.08
Testing RMSE: 0.80
</code></pre></div></div>

<p>This model has the best cross-validated train score, so although the test score isn’t the greatest, it’s the one I will select for my Flask app.</p>

<h3 id="conclusion">Conclusion</h3>
<p>Now the plan is:</p>
<ul>
  <li>Export the scaled dataset as a csv to be used in the Flask app</li>
  <li>Pickle the SVR model to use in the app</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">])</span>
<span class="n">y_concat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_scaled</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"X_ratings.csv"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final_model</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">final_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">y_concat</span><span class="p">)</span>
<span class="n">cv_scores</span> <span class="o">=</span> <span class="o">-</span><span class="n">ms</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">final_model</span><span class="p">,</span> <span class="n">X_scaled</span><span class="p">,</span> <span class="n">y_concat</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">'neg_mean_squared_error'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Cross-validated RMSEs:'</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Mean cross-validated RMSE:'</span><span class="p">,</span> <span class="s">'{0:0.2f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">))))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cross-validated RMSEs: [0.74717048 0.75255535 0.76234458 0.73663802 0.78108789]
Mean cross-validated RMSE: 0.76
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'model_ratings.pkl'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">final_model</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></div>


      <footer class="site-footer">
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
</footer>


    </section>

  </body>
</html>
